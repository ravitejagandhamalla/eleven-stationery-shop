{% extends "layout.html" %}
{% block content %}

<h2>Records</h2>


<form method="get" action="{{ url_for('view_records') }}">
    <label>Type</label>
    <select name="t">
        <option value="both" {% if t=='both' %}selected{% endif %}>Both</option>
        <option value="income" {% if t=='income' %}selected{% endif %}>Income</option>
        <option value="expenses" {% if t=='expenses' %}selected{% endif %}>Expenses</option>
    </select>

    <label>Start</label>
    <input type="date" name="start" value="{{ start or '' }}">

    <label>End</label>
    <input type="date" name="end" value="{{ end or '' }}">

    <button type="submit">Filter</button>
</form>

<hr>

{% if incomes %}
<h3>Income Records</h3>

<table border="1" width="100%">
    <tr>
        <th>Date</th>
        <th>Amount</th>
        <th>Description</th>
        <th>Action</th>
    </tr>

    {% for i in incomes %}
    <tr id="row-income-{{ i[0] }}">
        <td>{{ i[1] }}</td>
        <td>{{ i[2] }}</td>
        <td>{{ i[3] }}</td>
        <td>
            <button onclick="editIncome({{ i[0] }})">Update</button>
            <a href="{{ url_for('delete_income', id=i[0]) }}">Delete</a>
        </td>
    </tr>

    <!-- Hidden Edit Row -->
    <tr id="edit-income-{{ i[0] }}" style="display:none;">
        <form method="POST" action="{{ url_for('edit_income', id=i[0]) }}">
            <td>{{ i[1] }}</td>
            <td>
                <input type="number" name="amount" value="{{ i[2] }}" required>
            </td>
            <td>
                <input type="text" name="description" value="{{ i[3] }}">
            </td>
            <td>
                <button type="submit">Save</button>
                <button type="button" onclick="cancelIncome({{ i[0] }})">Cancel</button>
            </td>
        </form>
    </tr>
    {% endfor %}
</table>



{% endif %}


{% if expenses %}
<h3>Expense Records</h3>

<table border="1" width="100%">
    <tr>
        <th>Date</th>
        <th>Amount</th>
        <th>Purpose</th>
        <th>Action</th>
    </tr>

    {% for e in expenses %}
    <tr id="row-expense-{{ e[0] }}">
        <td>{{ e[1] }}</td>
        <td>{{ e[2] }}</td>
        <td>{{ e[3] }}</td>
        <td>
            <button onclick="editExpense({{ e[0] }})">Update</button>
            <a href="{{ url_for('delete_expense', id=e[0]) }}">Delete</a>
        </td>
    </tr>

    <!-- Hidden Edit Row -->
    <tr id="edit-expense-{{ e[0] }}" style="display:none;">
        <form method="POST" action="{{ url_for('edit_expenses', id=e[0]) }}">
            <td>{{ e[1] }}</td>
            <td>
                <input type="number" name="amount" value="{{ e[2] }}" required>
            </td>
            <td>
                <input type="text" name="description" value="{{ e[3] }}">
            </td>
            <td>
                <button type="submit">Save</button>
                <button type="button" onclick="cancelExpense({{ e[0] }})">Cancel</button>
            </td>
        </form>
    </tr>
    {% endfor %}
</table>


{% endif %}

{% endblock %}
<script>
function editIncome(id) {
    document.getElementById("row-income-" + id).style.display = "none";
    document.getElementById("edit-income-" + id).style.display = "";
}

function cancelIncome(id) {
    document.getElementById("row-income-" + id).style.display = "";
    document.getElementById("edit-income-" + id).style.display = "none";
}

function editExpense(id) {
    document.getElementById("row-expense-" + id).style.display = "none";
    document.getElementById("edit-expense-" + id).style.display = "";
}

function cancelExpense(id) {
    document.getElementById("row-expense-" + id).style.display = "";
    document.getElementById("edit-expense-" + id).style.display = "none";
}
</script>

