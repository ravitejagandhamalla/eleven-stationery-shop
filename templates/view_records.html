{% extends "layout.html" %}
{% block content %}

<h2>Records</h2>


<form method="get" action="{{ url_for('view_records') }}">
    <label>Type</label>
    <select name="t">
        <option value="both" {% if t=='both' %}selected{% endif %}>Both</option>
        <option value="income" {% if t=='income' %}selected{% endif %}>Income</option>
        <option value="expenses" {% if t=='expenses' %}selected{% endif %}>Expenses</option>
    </select>

    <label>Start</label>
    <input type="date" name="start" value="{{ start or '' }}">

    <label>End</label>
    <input type="date" name="end" value="{{ end or '' }}">

    <button type="submit">Filter</button>
</form>

<hr>

{% if incomes %}
<h3>Income Records</h3>

<table border="1" width="100%">
    <tr>
        <th>Date</th>
        <th>Amount</th>
        <th>Description</th>
        <th>Action</th>
    </tr>

    {% for i in incomes %}
    <!-- Normal Row -->
    <tr id="income-row-{{ i[0] }}">
        <td>{{ i[1] }}</td>
        <td>{{ i[2] }}</td>
        <td>{{ i[3] }}</td>
        <td>
            <button type="button" onclick="showIncomeEdit({{ i[0] }})">Update</button>
            <a href="{{ url_for('delete_income', id=i[0]) }}">Delete</a>
        </td>
    </tr>

    <!-- Hidden Edit Row -->
    <tr id="income-edit-{{ i[0] }}" style="display:none;">
        <td colspan="4">
            <form method="POST" action="{{ url_for('edit_income', id=i[0]) }}">
                Date: {{ i[1] }} <br><br>
                Amount:
                <input type="number" name="amount" value="{{ i[2] }}" required>

                Description:
                <input type="text" name="description" value="{{ i[3] }}">

                <button type="submit">Save</button>
                <button type="button" onclick="hideIncomeEdit({{ i[0] }})">Cancel</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>




{% endif %}


{% if expenses %}
<h3>Expense Records</h3>

<table border="1" width="100%">
    <tr>
        <th>Date</th>
        <th>Amount</th>
        <th>Purpose</th>
        <th>Action</th>
    </tr>

    {% for e in expenses %}
    <!-- Normal Row -->
    <tr id="expense-row-{{ e[0] }}">
        <td>{{ e[1] }}</td>
        <td>{{ e[2] }}</td>
        <td>{{ e[3] }}</td>
        <td>
            <button type="button" onclick="showExpenseEdit({{ e[0] }})">Update</button>
            <a href="{{ url_for('delete_expense', id=e[0]) }}">Delete</a>
        </td>
    </tr>

    <!-- Hidden Edit Row -->
    <tr id="expense-edit-{{ e[0] }}" style="display:none;">
        <td colspan="4">
            <form method="POST" action="{{ url_for('edit_expenses', id=e[0]) }}">
                Date: {{ e[1] }} <br><br>
                Amount:
                <input type="number" name="amount" value="{{ e[2] }}" required>

                Purpose:
                <input type="text" name="description" value="{{ e[3] }}">

                <button type="submit">Save</button>
                <button type="button" onclick="hideExpenseEdit({{ e[0] }})">Cancel</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>



{% endif %}

{% endblock %}
<script>
function showIncomeEdit(id) {
    document.getElementById("income-row-" + id).style.display = "none";
    document.getElementById("income-edit-" + id).style.display = "";
}

function hideIncomeEdit(id) {
    document.getElementById("income-row-" + id).style.display = "";
    document.getElementById("income-edit-" + id).style.display = "none";
}

function showExpenseEdit(id) {
    document.getElementById("expense-row-" + id).style.display = "none";
    document.getElementById("expense-edit-" + id).style.display = "";
}

function hideExpenseEdit(id) {
    document.getElementById("expense-row-" + id).style.display = "";
    document.getElementById("expense-edit-" + id).style.display = "none";
}
</script>

