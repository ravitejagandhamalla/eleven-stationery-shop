{% extends "layout.html" %}
{% block content %}

<h2>Records</h2>
<div style="margin-bottom:20px; display:flex; gap:10px; flex-wrap:wrap;">
    <a href="{{ url_for('export_filtered_excel', start=request.args.get('start'), end=request.args.get('end')) }}">
        ðŸ“Š Export Filtered Excel
    </a>

    <a href="{{ url_for('export_pdf') }}">
        ðŸ“„ Export PDF
    </a>

    <a href="{{ url_for('download_summary') }}">
        ðŸ“¥ Download Summary
    </a>
</div>
<div class="record-actions">
    <a href="{{ url_for('export_excel') }}" class="btn-export">
        ðŸ“Š Export to Excel
    </a>

    <button onclick="printRecords()" class="btn-print">
        ðŸ–¨ Print
    </button>
</div>

<form method="get" action="{{ url_for('view_records') }}">
    <label>Type</label>
    <select name="t">
        <option value="both" {% if t=='both' %}selected{% endif %}>Both</option>
        <option value="income" {% if t=='income' %}selected{% endif %}>Income</option>
        <option value="expenses" {% if t=='expenses' %}selected{% endif %}>Expenses</option>
    </select>

    <label>Start</label>
    <input type="date" name="start" value="{{ start or '' }}">

    <label>End</label>
    <input type="date" name="end" value="{{ end or '' }}">

    <button type="submit">Filter</button>
</form>

<hr>

{% if incomes %}
<h3>Income Records</h3>

<table border="1" width="100%">
    <tr>
        <th>Date</th>
        <th>Amount</th>
        <th>Description</th>
        <th>Action</th>
    </tr>

   {% for i in incomes %}
<tr>
    <form method="POST" action="{{ url_for('edit_income', id=i[0]) }}">
        <td>{{ i[1] }}</td>  <!-- date -->
        <td>
            <input type="number" name="amount" value="{{ i[2] }}" required>
        </td>
        <td>
            <input type="text" name="description" value="{{ i[3] }}">
        </td>
        <td>
            <button type="submit">Save</button>
            <a href="{{ url_for('delete_income', id=i[0]) }}">Delete</a>
        </td>
    </form>
</tr>
{% endfor %}

</table>




{% endif %}


{% if expenses %}
<h3>Expense Records</h3>

<table border="1" width="100%">
    <tr>
        <th>Date</th>
        <th>Amount</th>
        <th>Purpose</th>
        <th>Action</th>
    </tr>

    {% for e in expenses %}
<tr>
    <form method="POST" action="{{ url_for('edit_expenses', id=e[0]) }}">
        <td>{{ e[1] }}</td>  <!-- date -->
        <td>
            <input type="number" name="amount" value="{{ e[2] }}" required>
        </td>
        <td>
            <input type="text" name="purpose" value="{{ e[3] }}">
        </td>
        <td>
            <button type="submit">Save</button>
            <a href="{{ url_for('delete_expense', id=e[0]) }}">Delete</a>
        </td>
    </form>
</tr>
{% endfor %}

</table>



{% endif %}

{% endblock %}
<script>
function showIncomeEdit(id) {
    document.getElementById("income-row-" + id).style.display = "none";
    document.getElementById("income-edit-" + id).style.display = "";
}

function hideIncomeEdit(id) {
    document.getElementById("income-row-" + id).style.display = "";
    document.getElementById("income-edit-" + id).style.display = "none";
}

function showExpenseEdit(id) {
    document.getElementById("expense-row-" + id).style.display = "none";
    document.getElementById("expense-edit-" + id).style.display = "";
}

function hideExpenseEdit(id) {
    document.getElementById("expense-row-" + id).style.display = "";
    document.getElementById("expense-edit-" + id).style.display = "none";
}
    
function printRecords() {
    window.print();
}
</script>


